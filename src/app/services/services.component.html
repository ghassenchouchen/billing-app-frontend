<div class="page">
	<div class="page-header">
		<div>
			<h2 class="page-title">Services</h2>
			<p class="page-subtitle">Maintenez le catalogue de services et les règles tarifaires.</p>
		</div>
		<div class="page-actions">
			<span class="chip">{{listofServices.length || 0}} services</span>
			<span class="chip secondary">Catalogue en ligne</span>
		</div>
	</div>

	<div class="card section-card data-table">
		<div class="card-header">
			<div>
				<h5 class="card-title mb-0">Catalogue des services</h5>
			</div>
			<button class="btn btn-action primary" type="button" (click)="openCreateForm()" [disabled]="showForm">
				<span class="material-icons">add</span>
				Ajouter un service
			</button>
		</div>
		<div class="card-body">
			<div *ngIf="showForm" class="form-section">
				<h6>{{ formMode === 'create' ? 'Nouveau service' : 'Modifier le service' }}</h6>
				<div class="form-group">
					<label>Code</label>
					<input class="form-control" type="text" [(ngModel)]="formData.code" placeholder="Ex: SVC_DATA_01" />
				</div>
				<div class="form-group">
					<label>Nom du service</label>
					<input class="form-control" type="text" [(ngModel)]="formData.libelle" />
				</div>
				<div class="form-group">
					<label>Prix unitaire</label>
					<input class="form-control" type="number" [(ngModel)]="formData.prixUnitaire" step="0.01" />
				</div>
				<div class="form-group">
					<label>Unité</label>
					<select class="form-control" [(ngModel)]="formData.unite">
						<option value="SECONDE">Secondes (Appels)</option>
						<option value="OCTET">Octets (Internet)</option>
						<option value="SMS">SMS</option>
					</select>
				</div>
				<div class="form-group">
					<label>Catégorie</label>
					<select class="form-control" [(ngModel)]="formData.category">
						<option value="VOICE">Voix</option>
						<option value="DATA">Données</option>
						<option value="SMS">SMS</option>
						<option value="ROAMING">Roaming</option>
						<option value="VALUE_ADDED">Valeur ajoutée</option>
					</select>
				</div>
				<div class="form-actions">
					<button class="btn btn-action primary" type="button" (click)="saveService()" [disabled]="saving || !formData.libelle">
						{{ saving ? 'Sauvegarde…' : 'Sauvegarder' }}
					</button>
					<button class="btn btn-ghost" type="button" (click)="closeForm()" [disabled]="saving">
						Annuler
					</button>
				</div>
			</div>
			<div class="table-responsive">
				<table class="table table-striped table-hover">
					<thead>
						<tr>
							  <th>ID Service</th>
							  <th>Nom du service</th>
							  <th>Type</th>
							  <th>Prix</th>
							  <th>Statut</th>
							  <th>Actions</th>
						</tr>
					</thead>
					<tbody>
						<tr *ngFor="let service of listofServices">
							<td>{{service.id}}</td>
							<td>{{service.libelle || service.code}}</td>
							<td>{{service.unite}}</td>
							<td>{{service.prixUnitaire | number:'1.2-2'}}</td>
							<td>
								<span class="badge-soft success" *ngIf="service.active">Actif</span>
								<span class="badge-soft neutral" *ngIf="!service.active">Inactif</span>
							</td>
							<td class="actions-cell">
								<button class="btn btn-ghost" type="button" (click)="openEditForm(service)">
									<span class="material-icons">edit</span>
									Modifier
								</button>
								<button class="btn btn-ghost" type="button" (click)="deleteService(service.id)">
									<span class="material-icons">delete</span>
									Supprimer
								</button>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>

<app-confirm-modal
  [show]="showConfirmModal"
  [title]="confirmModalConfig.title"
  [message]="confirmModalConfig.message"
  confirmText="Supprimer"
  confirmClass="danger"
  (confirmed)="confirmModalConfig.action && confirmModalConfig.action()"
  (cancelled)="cancelConfirm()">
</app-confirm-modal>
